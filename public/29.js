(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{264:function(t,e,o){"use strict";o.r(e);var i=o(87);function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n={methods:{setPlace:function(){var t=this.autocomplete.getPlace();this.map.center=L.latLng(t.geometry.location.lat(),t.geometry.location.lng()),this.updateLats(t),this.getAddressObject(t.address_components)},updateLats:function(t){this.location.latitude=t.geometry.location.lat(),this.location.longitude=t.geometry.location.lng()},getAddressObject:function(t){var e={home:["street_number"],postal_code:["postal_code"],street:["street_address","route"],region:["administrative_area_level_1","administrative_area_level_2","administrative_area_level_3","administrative_area_level_4","administrative_area_level_5"],city:["locality","sublocality","sublocality_level_1","sublocality_level_2","sublocality_level_3","sublocality_level_4"],country:["country"]},o={home:"",postal_code:"",street:"",region:"",city:"",country:""};t.forEach((function(t){for(var i in e)-1!==e[i].indexOf(t.types[0])&&(o[i]="country"===i?t.short_name:t.long_name)})),this.updateLocationFields(o)},updateLocationFields:function(t){null!==t&&"object"===a(t)&&null!==t.id&&(this.location=_.extend(this.location,t))}}},c=o(81),s=o(82),r=o.n(s),l=o(253),d=o(254),u=o(255),h=o(83),v=o.n(h);function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var m={props:["event","remote"],mixins:[n,c.a],components:{Multiselect:r.a,LMap:l.a,LTileLayer:d.a,LMarker:u.a,CubeSpinner:i.a},computed:{locationPlaceholder:function(){return this.location.postal_code||this.location.city?(this.location.home?this.location.home+" ":"")+(this.location.street?this.location.street+", ":"")+(this.location.city?this.location.city+", ":"")+(this.location.country?this.location.country:""):"Enter full address "},remoteLocationArray:function(){return{remote:this.remoteLocations.map((function(t){return t.name})),description:this.description}},endpoint:function(){return"/create-event/".concat(this.event.slug,"/location")},corsEndpoint:function(){return"https://cors-anywhere.herokuapp.com/https://maps.googleapis.com/maps/api/geocode/json?address=".concat(this.location.postal_code?this.location.postal_code:this.location.city,"&key=AIzaSyBxpUKfSJMC4_3xwLU73AmH-jszjexoriw")}},data:function(){return{location:this.initializeLocationObject(),map:this.initializeMapObject(),active:null,disabled:!1,pageHeight:0,hasLocation:this.event.hasLocation,remoteLocationOptions:this.remote?this.remote:"",remoteLocations:this.event.remotelocations?this.event.remotelocations:"",description:this.event.remote_description?this.event.remote_description:"",serverErrors:[],loading:!1}},methods:{initializeLocationObject:function(){return{street:"",city:"",region:"",country:"",postal_code:"",hiddenLocation:"",hiddenLocationToggle:0,latitude:"",longitude:"",home:""}},initializeMapObject:function(){return{zoom:14,center:"",url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',allowZoom:!1}},onSubmit:function(t){return!this.checkVuelidate()&&(this.location.hiddenLocationToggle&&this.hasLocation?this.onCorsSubmit(t):this.onNormalSubmit(t))},onNormalSubmit:function(t){var e=this;axios.patch(this.endpoint,this.hasLocation?this.location:this.remoteLocationArray).then((function(o){"exit"==t?e.onBackInitial():e.onForward("category")})).catch((function(t){e.onErrors(t)}))},onCorsSubmit:function(t){var e=this;this.loading=!0,axios.get(this.corsEndpoint).then((function(t){e.location.latitude=t.data.results[0].geometry.location.lat,e.location.longitude=t.data.results[0].geometry.location.lng})).then((function(o){axios.patch(e.endpoint,e.location),"exit"==t?e.onBackInitial():e.onForward("category")})).catch((function(t){e.onErrors(t)}))},updateEventFields:function(t){null!==t&&"object"===p(t)&&null!==t.id&&(this.location=v.a.pick(t,v.a.intersection(v.a.keys(this.location),v.a.keys(t)))),this.location.latitude&&(this.map.center=L.latLng(this.location.latitude,this.location.longitude))},handleResize:function(){this.pageHeight="height:calc(".concat(window.innerHeight,"px - 7rem)")},addTag:function(t){var e={name:t,id:t.substring(0,0)+Math.floor(1e7*Math.random())};this.remoteLocationOptions.push(e),this.remoteLocations.push(e)},onLoad:function(){var t=this;axios.get(this.onFetch("location")).then((function(e){t.updateEventFields(e.data.location)}))}},created:function(){this.onLoad(),window.addEventListener("resize",this.handleResize),this.handleResize()},mounted:function(){this.autocomplete=new google.maps.places.Autocomplete(this.$refs.autocomplete,{types:["geocode"]}),this.autocomplete.addListener("place_changed",this.setPlace),this.updateEventFields(this.event.location)},destroyed:function(){window.removeEventListener("resize",this.handleResize)},validations:{location:{latitude:{ifLocation:function(){return!this.hasLocation||!!this.location.latitude}},city:{ifLocation:function(){return!this.hasLocation||!!this.location.city}}},remoteLocations:{ifNoLocation:function(){return!!this.hasLocation||!!this.remoteLocations.length}}}},f=o(80),g=Object(f.a)(m,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"event-create__location grid"},[o("section",{staticClass:"event-enter-location"},[t._m(0),t._v(" "),o("div",{staticClass:"field"},[o("label",[t._v(" Does your event have a physical location? ")]),t._v(" "),o("div",{attrs:{id:"cover"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.hasLocation,expression:"hasLocation"}],attrs:{type:"checkbox",id:"checkbox"},domProps:{checked:Array.isArray(t.hasLocation)?t._i(t.hasLocation,null)>-1:t.hasLocation},on:{change:function(e){var o=t.hasLocation,i=e.target,a=!!i.checked;if(Array.isArray(o)){var n=t._i(o,null);i.checked?n<0&&(t.hasLocation=o.concat([null])):n>-1&&(t.hasLocation=o.slice(0,n).concat(o.slice(n+1)))}else t.hasLocation=a}}}),t._v(" "),o("div",{attrs:{id:"bar"}}),t._v(" "),o("div",{attrs:{id:"knob"}},[t.hasLocation?o("p",[t._v("Yes")]):o("p",[t._v("No")])])])]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.hasLocation,expression:"hasLocation"}]},[o("div",{staticClass:"field"},[o("label",[t._v(" Is your location hidden? ")]),t._v(" "),o("div",{attrs:{id:"cover"}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.location.hiddenLocationToggle,expression:"location.hiddenLocationToggle"}],attrs:{type:"checkbox",id:"checkbox"},domProps:{checked:Array.isArray(t.location.hiddenLocationToggle)?t._i(t.location.hiddenLocationToggle,null)>-1:t.location.hiddenLocationToggle},on:{change:function(e){var o=t.location.hiddenLocationToggle,i=e.target,a=!!i.checked;if(Array.isArray(o)){var n=t._i(o,null);i.checked?n<0&&t.$set(t.location,"hiddenLocationToggle",o.concat([null])):n>-1&&t.$set(t.location,"hiddenLocationToggle",o.slice(0,n).concat(o.slice(n+1)))}else t.$set(t.location,"hiddenLocationToggle",a)}}}),t._v(" "),o("div",{attrs:{id:"bar"}}),t._v(" "),o("div",{attrs:{id:"knob"}},[t.location.hiddenLocationToggle?o("p",[t._v("Yes")]):o("p",[t._v("No")])])])]),t._v(" "),t.location.hiddenLocationToggle?o("div",{staticClass:"field"},[o("label",[t._v(" We still need your address so that users searching for this event can see the general area. They will not see the specific street address. ")]),t._v(" "),o("label",[t._v(" Please enter how participants will be notified of the location. (Required) ")]),t._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.location.hiddenLocation,expression:"location.hiddenLocation",modifiers:{trim:!0}}],class:{active:"hidden"==t.active},attrs:{rows:"4",required:"",autofocus:"",placeholder:"...the night before you will receieve an email containing the location..."},domProps:{value:t.location.hiddenLocation},on:{click:function(e){t.active="hidden"},blur:[function(e){t.active=null},function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||t.$set(t.location,"hiddenLocation",e.target.value.trim())}}})]):t._e(),t._v(" "),o("div",{staticClass:"field"},[o("label",[t._v(" Event Location ")]),t._v(" "),o("input",{ref:"autocomplete",class:{active:"location"==t.active,error:t.$v.location.latitude.$error},attrs:{placeholder:t.locationPlaceholder,autocomplete:"false",onfocus:"value = ''",type:"text"},on:{click:function(e){t.active="location"},blur:function(e){t.active=null}}}),t._v(" "),t.$v.location.$error?o("div",{staticClass:"validation-error"},[t.$v.location.latitude.ifLocation?t._e():o("p",{staticClass:"error"},[t._v("Please select from the list of locations")]),t._v(" "),t.$v.location.city.ifLocation?t._e():o("p",{staticClass:"error"},[t._v("We couldn't determine the city. Please try again.")])]):t._e()])]),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.hasLocation,expression:"!hasLocation"}]},[o("div",{staticClass:"field"},[o("label",[t._v(" What mediums will your remote event be using? ")]),t._v(" "),o("multiselect",{class:{active:"remote"==t.active,error:t.$v.remoteLocations.$error},attrs:{"tag-placeholder":"Add this as new tag",placeholder:"Type here to create your own",label:"name","close-on-select":!0,"track-by":"id",options:t.remoteLocationOptions,multiple:!0,taggable:!0,"tag-position":"bottom"},on:{tag:t.addTag,click:function(e){t.active="remote"},blur:function(e){t.active=null}},model:{value:t.remoteLocations,callback:function(e){t.remoteLocations=e},expression:"remoteLocations"}}),t._v(" "),t.$v.remoteLocations.$error?o("div",{staticClass:"validation-error"},[t.$v.remoteLocations.ifNoLocation?t._e():o("p",{staticClass:"error"},[t._v("Please choose at least one Mobile Location")])]):t._e()],1),t._v(" "),o("div",{staticClass:"field"},[o("label",{staticClass:"area"},[t._v(" Helpful remote location event suggestions (optional) ")]),t._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],class:{active:"description"==t.active},attrs:{type:"text",name:"description",placeholder:"eg. Sign on 10 minutes early...",rows:"8"},domProps:{value:t.description},on:{click:function(e){t.active="description"},blur:function(e){t.active=null},input:function(e){e.target.composing||(t.description=e.target.value)}}})])]),t._v(" "),o("CubeSpinner",{attrs:{loading:t.loading}})],1),t._v(" "),o("section",{staticClass:"event-show-location",style:t.pageHeight},[t.map.center&&t.hasLocation?o("div",{staticClass:"map"},[o("div",{staticClass:"zoom"},[o("div",{staticClass:"in"},[o("button",{on:{click:function(e){e.preventDefault(),t.map.zoom+=1}}},[o("svg",{attrs:{viewBox:"0 0 16 16",height:"16",width:"16",fill:"currentColor"}},[o("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7 1a1 1 0 0 1 2 0v14a1 1 0 1 1-2 0V1z"}}),o("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0 8a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H1a1 1 0 0 1-1-1z"}})])])]),t._v(" "),o("div",{staticClass:"out"},[o("button",{on:{click:function(e){e.preventDefault(),t.map.zoom-=1}}},[o("svg",{attrs:{viewBox:"0 0 16 16",height:"16",width:"16",fill:"currentColor"}},[o("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0 8a1 1 0 0 1 1-1h14a1 1 0 1 1 0 2H1a1 1 0 0 1-1-1z"}})])])])]),t._v(" "),o("div",{staticStyle:{width:"100%"},style:t.pageHeight},[o("l-map",{attrs:{zoom:t.map.zoom,center:t.map.center,options:{scrollWheelZoom:t.map.allowZoom,zoomControl:t.map.allowZoom}}},[o("l-tile-layer",{attrs:{url:t.map.url}}),t._v(" "),o("l-marker",{attrs:{"lat-lng":t.map.center}})],1)],1)]):t._e()]),t._v(" "),o("div",{staticClass:"event-create__submit-button"},[o("button",{staticClass:"nav-back-button",attrs:{disabled:t.disabled},on:{click:function(e){return e.preventDefault(),t.onSubmit("exit")}}},[t._v(" Save and Exit ")])]),t._v(" "),o("div",{staticClass:"create-button__back"},[o("button",{staticClass:"create",attrs:{disabled:t.disabled},on:{click:function(e){return e.preventDefault(),t.onBack("title")}}},[t._v(" Back ")])]),t._v(" "),o("div",{staticClass:"create-button__forward"},[o("button",{staticClass:"create",attrs:{disabled:t.disabled},on:{click:function(e){return e.preventDefault(),t.onSubmit()}}},[t._v(" Save and Continue ")])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("h2",[this._v("Location")])])}],!1,null,null,null);e.default=g.exports},81:function(t,e,o){"use strict";e.a={methods:{checkVuelidate:function(){return this.$v.$touch(),!this.$v.$invalid&&(this.disabled=!0),this.$v.$invalid},onErrors:function(t){t&&(this.serverErrors=t.response.data.errors),this.disabled=!1},onBackInitial:function(){return window.location.href="/create-event/edit/"},onBack:function(t){return window.location.href="/create-event/".concat(this.event.slug,"/").concat(t)},onFetch:function(t){return"/create-event/".concat(this.event.slug,"/").concat(t,"/fetch?timestamp=").concat((new Date).getTime())},onForward:function(t){return window.location.href="/create-event/".concat(this.event.slug,"/").concat(t)},onRegistered:function(){return window.location.href="/email/verify"},onFinishOrganizer:function(t){return window.location.href=t}}}},87:function(t,e,o){"use strict";var i={props:{loading:{type:Boolean,default:!0}},data:function(){return{styles:{width:this.width+"px",height:this.height+"px"}}},name:"CubeSpinner"},a=o(80),n=Object(a.a)(i,(function(){var t=this.$createElement,e=this._self._c||t;return this.loading?e("div",{staticClass:"spinner"},[this._m(0),this._v(" "),e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",version:"1.1"}},[e("defs",[e("filter",{attrs:{id:"goo"}},[e("feGaussianBlur",{attrs:{in:"SourceGraphic",stdDeviation:"10",result:"blur"}}),this._v(" "),e("feColorMatrix",{attrs:{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 21 -7"}})],1)])])]):this._e()}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"area"},[e("div",{staticClass:"dot dot-1"}),this._v(" "),e("div",{staticClass:"dot dot-2"}),this._v(" "),e("div",{staticClass:"dot dot-3"})])}],!1,null,null,null);e.a=n.exports}}]);